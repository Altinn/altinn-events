meta {
  name: GET Platform Token
  type: http
  seq: 1
}

get {
  url: https://altinn-testtools-token-generator.azurewebsites.net/api/GetEnterpriseToken?env=at22&scopes=altinn:serviceowner/instances.read&org=ttd&orgNo=991825827
  body: none
  auth: basic
}

params:query {
  env: at22
  scopes: altinn:serviceowner/instances.read
  org: ttd
  orgNo: 991825827
}

auth:basic {
  username: {{TokenGeneratorUsername}}
  password: {{TokenGeneratorPassword}}
}

script:post-response {
  const token = res.getBody();
  bru.setVar("PlatformToken", token);
}

settings {
  encodeUrl: true
}
